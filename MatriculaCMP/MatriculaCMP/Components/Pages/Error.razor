@page "/Error"
@using System.Diagnostics

<PageTitle>Error</PageTitle>

<div class="container py-4">
    <h1 class="text-danger">Error</h1>
    <h2 class="text-secondary">Ocurrió un error al procesar su solicitud.</h2>

    <p class="mt-3">
        Si estaba realizando una <strong>firma de diplomas</strong> (firmador no disponible, aplicación Biuen no instalada o recargó la página),
        puede volver al listado para intentar de nuevo.
    </p>

    <div class="card mt-3 border-0 shadow-sm">
        <div class="card-body">
            <h5 class="card-title">Volver al listado de firmas</h5>
            <p class="card-text text-muted">Seleccione el módulo correspondiente:</p>
            <div class="d-flex flex-wrap gap-2">
                <a href="/consejoregional/firmar-diplomas" class="btn btn-primary">
                    <i class="ri-user-2-line me-1"></i> Consejo Regional - Firmar diplomas
                </a>
                <a href="/secretariageneral/firmar-diplomas" class="btn btn-outline-primary">
                    <i class="ri-shield-star-line me-1"></i> Secretaría General - Firmar diplomas
                </a>
                <a href="/" class="btn btn-secondary">Inicio</a>
            </div>
        </div>
    </div>

    @if (ShowRequestId)
    {
        <p class="mt-3 small text-muted">
            <strong>Request ID:</strong> <code>@RequestId</code>
        </p>
    }

    <div class="mt-4 p-3 bg-light rounded">
        <h6>Modo desarrollo</h6>
        <p class="small mb-0">
            En entorno <strong>Development</strong> se muestra más detalle del error.
            No habilite Development en aplicaciones desplegadas. Para depuración local, configure <strong>ASPNETCORE_ENVIRONMENT</strong>=Development y reinicie la aplicación.
        </p>
    </div>
</div>

@code{
    [CascadingParameter]
    private HttpContext? HttpContext { get; set; }

    private string? RequestId { get; set; }
    private bool ShowRequestId => !string.IsNullOrEmpty(RequestId);

    protected override void OnInitialized() =>
        RequestId = Activity.Current?.Id ?? HttpContext?.TraceIdentifier;
}
